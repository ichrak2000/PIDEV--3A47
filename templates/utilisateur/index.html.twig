{% extends 'baseBack.html.twig' %}

{% block title %}Liste des Utilisateurs{% endblock %}

{% block contentblock %}
<div class="container">
    <h1 class="text-center mb-4">Liste des Utilisateurs</h1>
<div class="row mb-4">
        <div class="col text-center">
            <a href="{{ path('app_utilisateur_newAdmin') }}" class="btn btn-success">Créer Admin</a>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col-md-6 offset-md-3">
            <form action="{{ path('app_user_search') }}" method="get" class="input-group">
                <input type="text" name="email" class="form-control" placeholder="Recherche par email" required>
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Rechercher</button>
                </div>
            </form>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-6 offset-md-3">
            <form action="{{ path('app_utilisateur_search') }}" method="get" class="input-group">
                <input type="text" name="domain" class="form-control" placeholder="Recherche par domaine" required>
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Rechercher Domaine</button>
                </div>
            </form>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-6 offset-md-3">
            <div class="btn-group" role="group">
                <a href="{{ path('app_historique') }}" class="btn btn-primary">Historique</a>
                <a href="{{ path('app_utilisateur_statistiques') }}" class="btn btn-info">Voir les Statistiques</a>
                <a href="{{ path('app_utilisateur_sta2') }}" class="btn btn-info">Statistiques avec %</a>
            </div>
        </div>
    </div>
<div class="row mb-4">
    <div class="col text-center">
        {# ... autres boutons ... #}

        {# Bouton pour l'export Excel #}
        <a href="{{ path('export_excel') }}" class="btn btn-secondary">Exporter en Excel</a>
    </div>
</div>
<div class="row mb-4">
    <div class="col text-center">
        {# ... autres boutons ... #}

        {# Liens de tri pour le champ "Nom" #}
        <a href="{{ path('app_utilisateur_tri', {'sort': 'name', 'direction': 'ASC'}) }}" class="btn btn-outline-secondary">
            Trier par Nom (Ascendant)
        </a>
        <a href="{{ path('app_utilisateur_tri', {'sort': 'name', 'direction': 'DESC'}) }}" class="btn btn-outline-secondary">
            Trier par Nom (Descendant)
        </a>
    </div>
</div>


    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Actions</th>
                    <th>Role</th>
                    <th>Email</th>
                    <th>Nom</th>
                    <th>Prénom</th>
                    <th>Nom d'utilisateur</th>
                    <th>Image</th>
                    <th>Bio</th>
                    <th>Expérience</th>
                    <th>Formation</th>
                    <th>Total des missions</th>
                    <th>Évaluation</th>
                    <th>Domaine</th>
                    <th>Info</th>
                    <th>Localisation</th>
                    <th>Nb Employés</th>
                    <th>Est banni</th>
                </tr>
            </thead>
            <tbody>
                {% for utilisateur in utilisateurs %}
                <tr>
                    <td>
                        <a href="{{ path('app_utilisateur_show', {'id': utilisateur.id}) }}" class="btn btn-sm btn-primary">Afficher</a>
                        <a href="{{ path('app_utilisateur_edit', {'id': utilisateur.id}) }}" class="btn btn-sm btn-warning">Modifier</a>
                    </td>
                    <td>{{ utilisateur.role }}</td>
                    <td>{{ utilisateur.email }}</td>
                    <td>{{ utilisateur.name }}</td>
                    <td>{{ utilisateur.LastName }}</td>
                    <td>{{ utilisateur.UserName }}</td>
                    <td><img src="{{ asset(utilisateur.ImagePath) }}" alt="Image Utilisateur" class="img-thumbnail" style="width: 50px; height: auto;"></td>
                    <td>{{ utilisateur.bio }}</td>
                    <td>{{ utilisateur.experience }}</td>
                    <td>{{ utilisateur.education }}</td>
                    <td>{{ utilisateur.totalJobs }} Missions</td>
                    <td>{{ utilisateur.rating }}/20</td>
                    <td>{{ utilisateur.domaine }}</td>
                    <td>{{ utilisateur.info }}</td>
                    <td>{{ utilisateur.location }}</td>
                    <td>{{ utilisateur.nbe }}</td>
                    <td>{{ utilisateur.isBanned == 0 ? 'Non' : 'Oui' }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="17" class="text-center">Aucun enregistrement trouvé</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
